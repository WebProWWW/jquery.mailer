
/* author: Timur Valiyev | email: v.timur8484@gmail.com */

(function(){var t,n,r=function(t,n){return function(){return t.apply(n,arguments)}};t=jQuery,n=function(){function n(n,e){this.onSubmit=r(this.onSubmit,this),t.extend(this.settings,e),n.bind("submit",this.onSubmit)}return n.prototype.settings={action:"/",method:"POST",dataType:"json",sendingStr:"Sending...",success:function(t,n){},error:function(t){},emailRegex:/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i,process:!1},n.prototype.sendingCurrentHtml="",n.prototype.onSubmit=function(n){var r;return n.preventDefault(),r=t(n.target),this.validate(r.find("[validate]"))&&!this.process&&this.send(r),!1},n.prototype.send=function(n){return this.process=!0,this.progress(n),t.ajax({method:this.settings.method,url:this.settings.action,data:n.serialize(),dataType:this.settings.dataType}).done(function(t){return function(r){return t.success(n,r)}}(this)).fail(function(t){return function(){return t.error(n)}}(this)).always(function(t){return function(){return t.process=!1,t.always(n)}}(this)),!0},n.prototype.success=function(t,n){return t.trigger("reset"),this.settings.success(t,n)},n.prototype.error=function(t){return console.log("error($form)")},n.prototype.always=function(t){var n;return n=t.find(".js-mailer-progress"),n.html(this.sendingCurrentHtml),!0},n.prototype.progress=function(t){var n;return n=t.find(".js-mailer-progress"),this.sendingCurrentHtml=n.html(),n.html(this.settings.sendingStr),!0},n.prototype.inputError=function(n){var r;return r=n.parent(),r.addClass("has-error"),n.one("focusin",function(n){return t(this).parent().removeClass("has-error")}),!0},n.prototype.validate=function(n){var r;return r=!0,n.each(function(n){return function(e,i){var s,o,u,a;return s=t(i),a=s.attr("validate"),u=s.val(),o=function(){switch(a){case"text":return u.length>2;case"email":return this.settings.emailRegex.test(u);default:return!0}}.call(n),o||(r=o,n.inputError(s)),!0}}(this)),r},n}(),t.fn.extend({mailer:function(t){return new n(this,t)}})}).call(this);